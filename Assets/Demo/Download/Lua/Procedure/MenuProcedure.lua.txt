
MenuProcedure = {}

---@type IFsm
MenuProcedure.Fsm = nil;

---@type IUIForm
local menuForm;

function MenuProcedure.OnEnter(fsm, userData)
    MenuProcedure.Fsm = fsm;

    DrbComponent.SceneSystem.OnSceneLoaded = MenuProcedure.OnSceneLoaded;
    CS.DrbFrameworkDemo.SceneUtil.AddScene("scenes/menu.unity", LoadMode.Persistent, "Menu");
end

function MenuProcedure.OnUpdate(elapseSeconds, realElapseSeconds)

end

function MenuProcedure.OnLeave()
    DrbComponent.SceneSystem.OnSceneLoaded = DrbComponent.SceneSystem.OnSceneLoaded - MenuProcedure.OnSceneLoaded;

    if(menuForm ~= nil) then
        DrbComponent.UISystem:CloseForm(menuForm);
    end
end

function MenuProcedure.OnSceneLoaded(sceneName,mode)
    menuForm = DrbComponent.UISystem:OpenForm("UI/Forms/MenuForm.prefab",LoadMode.Editor);
    CS.DrbFrameworkDemo.AudioUtil.PlayBGM("audio/bgm/bgm_1.mp3","bgm_1",LoadMode.Persistent);
end